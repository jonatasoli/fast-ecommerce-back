============================= test session starts ==============================
platform linux -- Python 3.13.7, pytest-9.0.1, pluggy-1.6.0 -- /home/feanor/workspace/fast-ecommerce-back/.venv/bin/python
cachedir: .pytest_cache
rootdir: /home/feanor/workspace/fast-ecommerce-back
configfile: pyproject.toml
plugins: timeout-2.4.0, cov-7.0.0, env-1.2.0, xdist-3.8.0, mock-3.15.1, anyio-4.11.0, ordering-0.6, sugar-1.1.1, asyncio-1.3.0, Faker-38.2.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=function, asyncio_default_test_loop_scope=function
collecting ... 2025-12-05 14:30:12.356 | INFO     | app.infra.worker:<module>:5 - amqp://guest:guest@localhost:5672//
2025-12-05 14:30:12.900 | INFO     | main:<module>:85 - Environment: development
collected 124 items

tests/endpoints/cart/test_add_product.py::test_add_product_in_new_cart 2025-12-05T14:30:21.066993+0100 INFO product_db: product_id=1 name='Daniel Wall' uri='blog' price=Decimal('1E+4') active=True direct_sales=False description=[{'name': 'Leah Mitchell', 'residency': '310 Meadows Pine\nBassmouth, OR 14719'}, {'name': 'Elaine Clayton', 'residency': '333 Madison Islands\nMarkfort, KY 80005'}, {'name': 'Edward Young', 'residency': '76508 Megan Via Apt. 598\nMullentown, IN 88143'}, {'name': 'Katie Blankenship', 'residency': 'Unit 6228 Box 1465\nDPO AE 12720'}, {'name': 'Kelly Bennett', 'residency': '33322 Douglas Parks\nJeremymouth, HI 37260'}, {'name': 'Alexander Mcbride', 'residency': '024 Peters Rest\nWest Elizabethshire, DC 04185'}, {'name': 'Renee Odonnell', 'residency': '639 Diana Wells\nMargarethaven, WV 07709'}, {'name': 'Jeremy Ortega', 'residency': '54353 Morales Village Apt. 682\nDonaldsonburgh, MA 19612'}, {'name': 'April Hardy', 'residency': '986 Ross Ferry\nGreeneton, WI 06674'}, {'name': 'Shane Dixon', 'residency': '44549 Martinez Knolls\nWestbury, MP 72893'}] image_path=None installments_config=1 installments_list=None discount=None category_id=1 showcase=False show_discount=False height=9552 width=727 weight=4698 length=50 diameter=3676 quantity=0 sku='yYnznxtNzBDesVitkcWs'
PASSED
tests/endpoints/cart/test_estimate_cart.py::test_estimate_products_in_cart 2025-12-05T14:30:21.207286+0100 INFO b'{"uuid":"a437100e-031e-46a9-b640-28935dbefe86","affiliate":null,"cart_items":[{"product_id":3,"name":"Ryan da Rocha","image_path":"app","quantity":1,"available_quantity":0,"price":"100.00","description":null,"discount_price":"0"},{"product_id":2,"name":"Cau\xc3\xa3 Marques","image_path":"tags","quantity":1,"available_quantity":0,"price":"200.00","description":null,"discount_price":"0"}],"coupon":null,"discount":"0","zipcode":null,"freight_product_code":null,"freight":null,"subtotal":"300.00","total":"0"}'
2025-12-05T14:30:21.223124+0100 DEBUG Search campaign
2025-12-05T14:30:21.223317+0100 DEBUG Query Campaign
2025-12-05T14:30:21.223419+0100 DEBUG 2025-12-05 13:30:21.223411+00:00
2025-12-05T14:30:21.228217+0100 DEBUG Frete None
2025-12-05T14:30:21.228491+0100 DEBUG Preco 0
PASSED
tests/endpoints/catalog/test_categories.py::test_empty_data_should_return_200 PASSED
tests/endpoints/catalog/test_categories.py::test_with_categories_list PASSED
tests/endpoints/catalog/test_category_endpoint.py::test_get_category_by_id_should_return_200 PASSED
tests/endpoints/catalog/test_category_endpoint.py::test_get_category_by_id_not_found_should_return_404 PASSED
tests/endpoints/catalog/test_category_endpoint.py::test_create_category_should_return_201 PASSED
tests/endpoints/catalog/test_category_endpoint.py::test_create_category_without_auth_should_return_401 PASSED
tests/endpoints/catalog/test_category_endpoint.py::test_create_category_invalid_data_should_return_422 PASSED
tests/endpoints/catalog/test_category_endpoint.py::test_update_category_should_return_200 PASSED
tests/endpoints/catalog/test_category_endpoint.py::test_update_category_not_found_should_return_404 PASSED
tests/endpoints/catalog/test_category_endpoint.py::test_delete_category_should_return_204 PASSED
tests/endpoints/catalog/test_category_endpoint.py::test_delete_category_not_found_should_return_404 PASSED
tests/endpoints/catalog/test_category_media_endpoints.py::test_upload_category_image_should_return_200 PASSED
tests/endpoints/catalog/test_category_media_endpoints.py::test_upload_category_image_not_found_should_return_404 PASSED
tests/endpoints/catalog/test_category_media_endpoints.py::test_upload_category_media_gallery_should_return_201 2025-12-05T14:30:23.305025+0100 DEBUG Media id 1
2025-12-05T14:30:23.307261+0100 DEBUG Category Media Gallery id 1
2025-12-05T14:30:23.307391+0100 DEBUG Media id 1
PASSED
tests/endpoints/catalog/test_category_media_endpoints.py::test_get_category_media_gallery_should_return_200 PASSED
tests/endpoints/catalog/test_category_media_endpoints.py::test_delete_category_media_should_return_204 PASSED
tests/endpoints/catalog/test_product_path.py::test_with_product_list_only_category_path 2025-12-05T14:30:23.771698+0100 INFO test
PASSED
tests/endpoints/catalog/test_products_all.py::test_empty_data_should_return_200 PASSED
tests/endpoints/catalog/test_products_all.py::test_with_product_list_only_activated PASSED
tests/endpoints/catalog/test_products_featured.py::test_empty_data_should_return_200 PASSED
tests/endpoints/catalog/test_products_featured.py::test_with_product_list_only_featured PASSED
tests/endpoints/catalog/test_products_latest.py::test_empty_data_should_return_200 PASSED
tests/endpoints/catalog/test_products_latest.py::test_with_product_list_only_last_product PASSED
tests/endpoints/catalog/test_search_product.py::test_empty_data_should_return_200 PASSED
tests/endpoints/catalog/test_search_product.py::test_with_product_list_only_activated PASSED
tests/endpoints/catalog/test_showcase.py::test_empty_data_should_return_200 2025-12-05T14:30:24.748921+0100 DEBUG Currency BRL
PASSED
tests/endpoints/catalog/test_showcase.py::test_with_product_showcase_option_should_list 2025-12-05T14:30:24.787700+0100 DEBUG Currency BRL
PASSED
tests/endpoints/order/test_get_orders.py::test_give_no_orders_should_return_empty_list PASSED
tests/endpoints/order/test_get_orders.py::test_get_all_orders PASSED
tests/endpoints/product/test_create_product_endpoint.py::test_given_valid_payload_should_create_product SKIPPED
tests/endpoints/product/test_upload_image.py::test_add_new_image_file_in_product SKIPPED
tests/endpoints/report/test_sales_commissions.py::test_empty_report_should_empy_list PASSED
tests/endpoints/user/test_token.py::test_get_token SKIPPED
tests/entities/test_cart.py::test_create_uuid_to_cart PASSED
tests/entities/test_cart.py::test_create_base_cart PASSED
tests/entities/test_cart.py::test_increase_product_to_cart PASSED
tests/entities/test_cart.py::test_decrease_product_to_cart PASSED
tests/entities/test_cart.py::test_set_product_quantity_to_cart PASSED
tests/entities/test_cart.py::test_add_product_to_cart PASSED
tests/entities/test_cart.py::test_add_duplicate_product_should_increase_quantity PASSED
tests/entities/test_cart.py::test_remove_product_to_cart PASSED
tests/entities/test_cart.py::test_remove_product_to_cart_with_product_not_exists PASSED2025-12-05T14:30:25.079298+0100 ERROR Product id 2 don't exists in cart

tests/entities/test_cart.py::test_add_product_price_to_cart PASSED
tests/entities/test_cart.py::test_calculate_subtotal_to_cart PASSED2025-12-05T14:30:25.084663+0100 DEBUG Frete None

tests/entities/test_cart.py::test_calculate_subtotal_in_cart_without_prices_raise_cart_error 2025-12-05T14:30:25.084828+0100 DEBUG Preco 0
PASSED2025-12-05T14:30:25.088037+0100 ERROR Price or quantity not found in cart item

tests/entities/test_cart.py::test_calculate_subtotal_in_cart_with_cart_items_empty_raise_value_error PASSED
tests/entities/test_cart.py::test_calculate_subtotal_in_cart_with_coupon PASSED
tests/entities/test_catalog.py::test_category_create_valid PASSED
tests/entities/test_catalog.py::test_category_create_with_defaults PASSED
tests/entities/test_catalog.py::test_category_create_missing_required_field PASSED
tests/entities/test_catalog.py::test_category_update_partial PASSED
tests/entities/test_catalog.py::test_category_update_all_fields PASSED
tests/entities/test_catalog.py::test_category_response_valid PASSED
tests/entities/test_catalog.py::test_category_model_validate PASSED
tests/entities/test_catalog.py::test_categories_list PASSED
tests/entities/test_category_exception.py::test_category_not_found_error_default_message 2025-12-05T14:30:25.089848+0100 ERROR Cart items is empty
PASSED2025-12-05T14:30:25.092038+0100 DEBUG Frete None

tests/entities/test_category_exception.py::test_category_not_found_error_custom_message 2025-12-05T14:30:25.092154+0100 DEBUG Preco 0
PASSED
tests/entities/test_category_exception.py::test_category_not_found_error_is_exception PASSED
tests/entities/test_category_exception.py::test_category_not_found_error_can_be_raised PASSED
tests/entities/test_category_exception.py::test_category_media_not_found_error_default_message PASSED
tests/entities/test_category_exception.py::test_category_media_not_found_error_custom_message PASSED
tests/entities/test_category_exception.py::test_category_media_not_found_error_is_exception PASSED
tests/entities/test_category_exception.py::test_category_media_not_found_error_can_be_raised PASSED
tests/entities/test_product.py::test_uploaded_create_model_should_valid_data PASSED
tests/entities/test_product.py::test_uploaded_create_model_with_invalid_type_should_exception PASSED
tests/models/test_category_db.py::test_create_category PASSED
tests/models/test_category_db.py::test_category_default_values PASSED
tests/models/test_category_db.py::test_category_with_image_path PASSED
tests/models/test_category_media_gallery_db.py::test_create_category_media_gallery PASSED
tests/models/test_category_media_gallery_db.py::test_category_media_gallery_foreign_keys PASSED
tests/models/test_orderdb_model.py::test_create_order PASSED
tests/models/test_orderdb_model.py::test_order_status_steps PASSED
tests/models/test_role.py::test_create_role PASSED
tests/models/test_uploaded_image.py::test_create_media PASSED
tests/models/test_userdb.py::test_create_user PASSED
tests/repository/users/test_get_users.py::test_get_users_with_name_filter PASSED
tests/repository/users/test_get_users.py::test_get_users_with_document_filter PASSED
tests/repository/users/test_get_users.py::test_get_users_with_ordering_and_pagination PASSED
tests/repository/users/test_get_users.py::test_get_users_no_filters PASSED
tests/services/cart/test_cart_estimate.py::test_estimate_cart_with_product 2025-12-05T14:30:25.715314+0100 INFO {"uuid":"18a58986-3b5f-41ec-aa50-857f2a353dd7","affiliate":null,"cart_items":[{"product_id":1,"name":"Alexia Vargas","image_path":"main","quantity":1,"available_quantity":10,"price":null,"description":null,"discount_price":"0"},{"product_id":2,"name":"Sr. Gabriel Fonseca","image_path":"tags","quantity":1,"available_quantity":10,"price":null,"description":null,"discount_price":"0"}],"coupon":null,"discount":"0","zipcode":null,"freight_product_code":null,"freight":null,"subtotal":"10","total":"0"}
2025-12-05T14:30:25.715982+0100 DEBUG Search campaign
2025-12-05T14:30:25.716101+0100 DEBUG Query Campaign
2025-12-05T14:30:25.716179+0100 DEBUG 2025-12-05 13:30:25.716172+00:00
PASSED2025-12-05T14:30:25.755318+0100 DEBUG Frete None
2025-12-05T14:30:25.755498+0100 DEBUG Preco 0

tests/services/cart/test_cart_estimate.py::test_estimate_cart_with_coupon_discount 2025-12-05T14:30:25.787289+0100 INFO {"uuid":"6ca1b199-f8e3-46cd-9e51-dcac841ddbbd","affiliate":null,"cart_items":[{"product_id":1,"name":"Agatha Silva","image_path":"list/tags/wp-content","quantity":1,"available_quantity":10,"price":null,"description":null,"discount_price":"0"},{"product_id":2,"name":"Nicole Garcia","image_path":"tags","quantity":1,"available_quantity":10,"price":null,"description":null,"discount_price":"0"}],"coupon":"D10","discount":"0","zipcode":null,"freight_product_code":null,"freight":null,"subtotal":"10","total":"0"}
2025-12-05T14:30:25.788407+0100 DEBUG Search campaign
2025-12-05T14:30:25.788537+0100 DEBUG Query Campaign
2025-12-05T14:30:25.788622+0100 DEBUG 2025-12-05 13:30:25.788614+00:00
PASSED2025-12-05T14:30:25.831311+0100 DEBUG Frete None
2025-12-05T14:30:25.831486+0100 DEBUG Preco 0

tests/services/cart/test_cart_step_1.py::test_add_product_to_new_cart PASSED2025-12-05T14:30:25.869371+0100 INFO product_db: <app.infra.models.ProductDB object at 0x7f47616e5950>
2025-12-05T14:30:25.869589+0100 DEBUG Product values <app.infra.models.ProductDB object at 0x7f47616e5950>

tests/services/cart/test_cart_step_1.py::test_add_product_to_new_cart_should_set_in_cache PASSED2025-12-05T14:30:25.935883+0100 INFO product_db: <app.infra.models.ProductDB object at 0x7f47616e4950>
2025-12-05T14:30:25.936048+0100 DEBUG Product values <app.infra.models.ProductDB object at 0x7f47616e4950>

tests/services/cart/test_cart_step_1.py::test_add_product_to_current_cart_should_add_new_product_should_calculate_subtotal PASSED2025-12-05T14:30:25.995468+0100 INFO product_db: <app.infra.models.ProductDB object at 0x7f47616e6350>

tests/services/cart/test_cart_step_1.py::test_given_cart_with_items_with_discount_need_calculate_to_preview 2025-12-05T14:30:26.065878+0100 INFO {"uuid":"cc3fec57-5bee-404c-93fb-87f6b0ea491d","affiliate":null,"cart_items":[{"product_id":2,"name":"Dra. Eduarda Sampaio","image_path":"tags/app/posts","quantity":1,"available_quantity":10,"price":null,"description":null,"discount_price":"50"},{"product_id":1,"name":"Apollo Sales","image_path":"category/search","quantity":1,"available_quantity":10,"price":null,"description":null,"discount_price":"50"}],"coupon":null,"discount":"0","zipcode":null,"freight_product_code":null,"freight":null,"subtotal":"10","total":"0"}
2025-12-05T14:30:26.066550+0100 DEBUG Search campaign
2025-12-05T14:30:26.066676+0100 DEBUG Query Campaign
2025-12-05T14:30:26.066753+0100 DEBUG 2025-12-05 13:30:26.066746+00:00
PASSED2025-12-05T14:30:26.106209+0100 DEBUG Frete None
2025-12-05T14:30:26.106381+0100 DEBUG Preco 0

tests/services/catalog/test_category_media_services.py::test_upload_category_image_should_update_image_path PASSED
tests/services/catalog/test_category_media_services.py::test_upload_category_image_not_found_should_raise_exception PASSED
tests/services/catalog/test_category_media_services.py::test_upload_category_media_gallery_should_upload_photo 2025-12-05T14:30:26.384209+0100 DEBUG Media id 3
2025-12-05T14:30:26.385795+0100 DEBUG Category Media Gallery id 3
2025-12-05T14:30:26.385930+0100 DEBUG Media id 3
PASSED
tests/services/catalog/test_category_media_services.py::test_upload_category_media_gallery_category_not_found_should_raise PASSED
tests/services/catalog/test_category_media_services.py::test_get_category_media_gallery_should_return_media_list PASSED
tests/services/catalog/test_category_media_services.py::test_get_category_media_gallery_category_not_found_should_raise PASSED
tests/services/catalog/test_category_media_services.py::test_delete_category_media_gallery_should_delete_media PASSED
tests/services/catalog/test_category_media_services.py::test_delete_category_media_gallery_category_not_found_should_raise PASSED
tests/services/catalog/test_category_media_services.py::test_delete_category_media_gallery_media_not_found_should_raise PASSED
tests/services/catalog/test_category_services.py::test_create_category_should_return_category PASSED
tests/services/catalog/test_category_services.py::test_get_category_by_id_should_return_category PASSED
tests/services/catalog/test_category_services.py::test_get_category_by_id_not_found_should_return_none PASSED
tests/services/catalog/test_category_services.py::test_update_category_should_return_updated_category PASSED
tests/services/catalog/test_category_services.py::test_update_category_not_found_should_return_none PASSED
tests/services/catalog/test_category_services.py::test_delete_category_should_delete_category PASSED
tests/services/catalog/test_category_services.py::test_delete_category_not_found_should_raise_exception PASSED
tests/services/mail/test_mail_clients.py::test_send_email_with_sendgrid 2025-12-05T14:30:27.642809+0100 DEBUG Token Enc - b'{"secret": "SENDGRID_SECRET"}'
2025-12-05T14:30:27.642982+0100 DEBUG Key Enc - RVd9r6ly08gbPMGi1EWbB_BWPKzd2n_uriOIipxDN70=
PASSED2025-12-05T14:30:27.647855+0100 DEBUG PRE CONFIG b'gAAAAABpMt5zjCdr_4pCCp4LqAgy-uMFV0aA97GNDTpRxmoaQCwHhV84OkV0uqyVbMfBmccU7E3tISqhAvKXv2mnbsOBMRlPPi03FmbGoxB3ndtO8S8U_vs='

tests/services/mail/test_mail_clients.py::test_send_email_fallback_legacy 2025-12-05T14:30:27.648071+0100 DEBUG Token - b'gAAAAABpMt5zjCdr_4pCCp4LqAgy-uMFV0aA97GNDTpRxmoaQCwHhV84OkV0uqyVbMfBmccU7E3tISqhAvKXv2mnbsOBMRlPPi03FmbGoxB3ndtO8S8U_vs='
PASSED2025-12-05T14:30:27.648163+0100 DEBUG Key - b'RVd9r6ly08gbPMGi1EWbB_BWPKzd2n_uriOIipxDN70='

tests/services/mail/test_mail_clients.py::test_send_email_raises_on_failure 2025-12-05T14:30:27.648349+0100 DEBUG FIELD DECRIPT {"secret": "SENDGRID_SECRET"}
2025-12-05T14:30:27.648523+0100 DEBUG DECRIPT b'gAAAAABpMt5zjCdr_4pCCp4LqAgy-uMFV0aA97GNDTpRxmoaQCwHhV84OkV0uqyVbMfBmccU7E3tISqhAvKXv2mnbsOBMRlPPi03FmbGoxB3ndtO8S8U_vs=' e RVd9r6ly08gbPMGi1EWbB_BWPKzd2n_uriOIipxDN70=
2025-12-05T14:30:27.648624+0100 DEBUG  CONFIG {'secret': 'SENDGRID_SECRET'}
PASSED2025-12-05T14:30:27.648691+0100 DEBUG None

tests/services/payment/test_process_payment_mercado_pago_credit_card.py::test_create_payment_credit_card_success_method 2025-12-05T14:30:27.648750+0100 DEBUG None
2025-12-05T14:30:27.648804+0100 DEBUG None
2025-12-05T14:30:27.649516+0100 INFO 202
2025-12-05T14:30:27.649654+0100 INFO OK
2025-12-05T14:30:27.649732+0100 INFO {'X-Test': 'Header'}
2025-12-05T14:30:27.651690+0100 DEBUG Token Enc - b'{"provider": "legacy"}'
2025-12-05T14:30:27.651811+0100 DEBUG Key Enc - RVd9r6ly08gbPMGi1EWbB_BWPKzd2n_uriOIipxDN70=
2025-12-05T14:30:27.654759+0100 DEBUG PRE CONFIG b'gAAAAABpMt5zX8vqWCpzFSkeC6452CehHuovkBE1lKHtc0rkNwZYDFjM0xywMbwSfmKxGLQ6iYxskJr1HmnbfUwwv3YgsYb3VehO2j2s6SPgpzm3gZAN0TQ='
2025-12-05T14:30:27.654965+0100 DEBUG Token - b'gAAAAABpMt5zX8vqWCpzFSkeC6452CehHuovkBE1lKHtc0rkNwZYDFjM0xywMbwSfmKxGLQ6iYxskJr1HmnbfUwwv3YgsYb3VehO2j2s6SPgpzm3gZAN0TQ='
2025-12-05T14:30:27.655054+0100 DEBUG Key - b'RVd9r6ly08gbPMGi1EWbB_BWPKzd2n_uriOIipxDN70='
2025-12-05T14:30:27.655205+0100 DEBUG FIELD DECRIPT {"provider": "legacy"}
2025-12-05T14:30:27.655354+0100 DEBUG DECRIPT b'gAAAAABpMt5zX8vqWCpzFSkeC6452CehHuovkBE1lKHtc0rkNwZYDFjM0xywMbwSfmKxGLQ6iYxskJr1HmnbfUwwv3YgsYb3VehO2j2s6SPgpzm3gZAN0TQ=' e RVd9r6ly08gbPMGi1EWbB_BWPKzd2n_uriOIipxDN70=
2025-12-05T14:30:27.655446+0100 DEBUG  CONFIG {'provider': 'legacy'}
2025-12-05T14:30:27.655524+0100 DEBUG legacy
2025-12-05T14:30:27.655599+0100 DEBUG None
2025-12-05T14:30:27.655664+0100 DEBUG legacy
2025-12-05T14:30:27.656008+0100 INFO 202
2025-12-05T14:30:27.656116+0100 INFO OK
2025-12-05T14:30:27.656186+0100 INFO {'X-Test': 'Header'}
2025-12-05T14:30:27.658187+0100 DEBUG Token Enc - b'{"secret": "SENDGRID_SECRET"}'
2025-12-05T14:30:27.658326+0100 DEBUG Key Enc - RVd9r6ly08gbPMGi1EWbB_BWPKzd2n_uriOIipxDN70=
2025-12-05T14:30:27.661785+0100 DEBUG PRE CONFIG b'gAAAAABpMt5z04yoyNCC-xA2K10tXChdjyzKCML8Ie16rbr8cRe8pdoyfIVdG2o7NyUsgbxNK6UmN7JVpOaUuSoipU3eLuYWlxWVv7hGP1PyLP8_yLfpIAQ='
2025-12-05T14:30:27.662003+0100 DEBUG Token - b'gAAAAABpMt5z04yoyNCC-xA2K10tXChdjyzKCML8Ie16rbr8cRe8pdoyfIVdG2o7NyUsgbxNK6UmN7JVpOaUuSoipU3eLuYWlxWVv7hGP1PyLP8_yLfpIAQ='
2025-12-05T14:30:27.662092+0100 DEBUG Key - b'RVd9r6ly08gbPMGi1EWbB_BWPKzd2n_uriOIipxDN70='
2025-12-05T14:30:27.662246+0100 DEBUG FIELD DECRIPT {"secret": "SENDGRID_SECRET"}
2025-12-05T14:30:27.662416+0100 DEBUG DECRIPT b'gAAAAABpMt5z04yoyNCC-xA2K10tXChdjyzKCML8Ie16rbr8cRe8pdoyfIVdG2o7NyUsgbxNK6UmN7JVpOaUuSoipU3eLuYWlxWVv7hGP1PyLP8_yLfpIAQ=' e RVd9r6ly08gbPMGi1EWbB_BWPKzd2n_uriOIipxDN70=
2025-12-05T14:30:27.662528+0100 DEBUG  CONFIG {'secret': 'SENDGRID_SECRET'}
2025-12-05T14:30:27.662605+0100 DEBUG None
2025-12-05T14:30:27.662684+0100 DEBUG None
2025-12-05T14:30:27.662752+0100 DEBUG None
2025-12-05T14:30:27.663184+0100 INFO 500
PASSED2025-12-05T14:30:27.663333+0100 INFO <Mock name='mock.body' id='139944555396272'>
2025-12-05T14:30:27.663511+0100 INFO {'X-Test': 'Header'}
2025-12-05T14:30:27.663744+0100 ERROR Error in sended email
[33m[1mTraceback (most recent call last):[0m

  File "/home/feanor/workspace/fast-ecommerce-back/.venv/bin/pytest", line 8, in <module>
    sys.exit(console_main())
    â”‚   â”‚    â”” <function console_main at 0x7f4772894ea0>
    â”‚   â”” <built-in function exit>
    â”” <module 'sys' (built-in)>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 221, in console_main
    code = main()
           â”” <function main at 0x7f4772894e00>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 197, in main
    ret: ExitCode | int = config.hook.pytest_cmdline_main(config=config)
         â”‚                â”‚      â”‚    â”‚                          â”” <_pytest.config.Config object at 0x7f4772514050>
         â”‚                â”‚      â”‚    â”” <HookCaller 'pytest_cmdline_main'>
         â”‚                â”‚      â”” <_pytest.config.compat.PathAwareHookProxy object at 0x7f4772514d70>
         â”‚                â”” <_pytest.config.Config object at 0x7f4772514050>
         â”” <enum 'ExitCode'>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           â”‚    â”‚         â”‚    â”‚     â”‚    â”‚                  â”‚       â”” True
           â”‚    â”‚         â”‚    â”‚     â”‚    â”‚                  â”” {'config': <_pytest.config.Config object at 0x7f4772514050>}
           â”‚    â”‚         â”‚    â”‚     â”‚    â”” <member '_hookimpls' of 'HookCaller' objects>
           â”‚    â”‚         â”‚    â”‚     â”” <HookCaller 'pytest_cmdline_main'>
           â”‚    â”‚         â”‚    â”” <member 'name' of 'HookCaller' objects>
           â”‚    â”‚         â”” <HookCaller 'pytest_cmdline_main'>
           â”‚    â”” <member '_hookexec' of 'HookCaller' objects>
           â”” <HookCaller 'pytest_cmdline_main'>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           â”‚    â”‚               â”‚          â”‚        â”‚       â”” True
           â”‚    â”‚               â”‚          â”‚        â”” {'config': <_pytest.config.Config object at 0x7f4772514050>}
           â”‚    â”‚               â”‚          â”” [<HookImpl plugin_name='main', plugin=<module '_pytest.main' from '/home/feanor/workspace/fast-ecommerce-back/.venv/lib/pytho...
           â”‚    â”‚               â”” 'pytest_cmdline_main'
           â”‚    â”” <function _multicall at 0x7f4772b6e0c0>
           â”” <_pytest.config.PytestPluginManager object at 0x7f47726fd7f0>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    res = hook_impl.function(*args)
          â”‚         â”‚         â”” [<_pytest.config.Config object at 0x7f4772514050>]
          â”‚         â”” <member 'function' of 'HookImpl' objects>
          â”” <HookImpl plugin_name='main', plugin=<module '_pytest.main' from '/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python...
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/_pytest/main.py", line 365, in pytest_cmdline_main
    return wrap_session(config, _main)
           â”‚            â”‚       â”” <function _main at 0x7f4772757920>
           â”‚            â”” <_pytest.config.Config object at 0x7f4772514050>
           â”” <function wrap_session at 0x7f47727577e0>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/_pytest/main.py", line 318, in wrap_session
    session.exitstatus = doit(config, session) or 0
    â”‚       â”‚            â”‚    â”‚       â”” <Session  exitstatus=<ExitCode.OK: 0> testsfailed=0 testscollected=124>
    â”‚       â”‚            â”‚    â”” <_pytest.config.Config object at 0x7f4772514050>
    â”‚       â”‚            â”” <function _main at 0x7f4772757920>
    â”‚       â”” <ExitCode.OK: 0>
    â”” <Session  exitstatus=<ExitCode.OK: 0> testsfailed=0 testscollected=124>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/_pytest/main.py", line 372, in _main
    config.hook.pytest_runtestloop(session=session)
    â”‚      â”‚    â”‚                          â”” <Session  exitstatus=<ExitCode.OK: 0> testsfailed=0 testscollected=124>
    â”‚      â”‚    â”” <HookCaller 'pytest_runtestloop'>
    â”‚      â”” <_pytest.config.compat.PathAwareHookProxy object at 0x7f4772514d70>
    â”” <_pytest.config.Config object at 0x7f4772514050>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           â”‚    â”‚         â”‚    â”‚     â”‚    â”‚                  â”‚       â”” True
           â”‚    â”‚         â”‚    â”‚     â”‚    â”‚                  â”” {'session': <Session  exitstatus=<ExitCode.OK: 0> testsfailed=0 testscollected=124>}
           â”‚    â”‚         â”‚    â”‚     â”‚    â”” <member '_hookimpls' of 'HookCaller' objects>
           â”‚    â”‚         â”‚    â”‚     â”” <HookCaller 'pytest_runtestloop'>
           â”‚    â”‚         â”‚    â”” <member 'name' of 'HookCaller' objects>
           â”‚    â”‚         â”” <HookCaller 'pytest_runtestloop'>
           â”‚    â”” <member '_hookexec' of 'HookCaller' objects>
           â”” <HookCaller 'pytest_runtestloop'>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           â”‚    â”‚               â”‚          â”‚        â”‚       â”” True
           â”‚    â”‚               â”‚          â”‚        â”” {'session': <Session  exitstatus=<ExitCode.OK: 0> testsfailed=0 testscollected=124>}
           â”‚    â”‚               â”‚          â”” [<HookImpl plugin_name='main', plugin=<module '_pytest.main' from '/home/feanor/workspace/fast-ecommerce-back/.venv/lib/pytho...
           â”‚    â”‚               â”” 'pytest_runtestloop'
           â”‚    â”” <function _multicall at 0x7f4772b6e0c0>
           â”” <_pytest.config.PytestPluginManager object at 0x7f47726fd7f0>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    res = hook_impl.function(*args)
          â”‚         â”‚         â”” [<Session  exitstatus=<ExitCode.OK: 0> testsfailed=0 testscollected=124>]
          â”‚         â”” <member 'function' of 'HookImpl' objects>
          â”” <HookImpl plugin_name='main', plugin=<module '_pytest.main' from '/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python...
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/_pytest/main.py", line 396, in pytest_runtestloop
    item.config.hook.pytest_runtest_protocol(item=item, nextitem=nextitem)
    â”‚    â”‚                                        â”‚              â”” <Coroutine test_create_payment_credit_card_success_method>
    â”‚    â”‚                                        â”” <Function test_send_email_raises_on_failure>
    â”‚    â”” <member 'config' of 'Node' objects>
    â”” <Function test_send_email_raises_on_failure>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           â”‚    â”‚         â”‚    â”‚     â”‚    â”‚                  â”‚       â”” True
           â”‚    â”‚         â”‚    â”‚     â”‚    â”‚                  â”” {'item': <Function test_send_email_raises_on_failure>, 'nextitem': <Coroutine test_create_payment_credit_card_success_method>}
           â”‚    â”‚         â”‚    â”‚     â”‚    â”” <member '_hookimpls' of 'HookCaller' objects>
           â”‚    â”‚         â”‚    â”‚     â”” <HookCaller 'pytest_runtest_protocol'>
           â”‚    â”‚         â”‚    â”” <member 'name' of 'HookCaller' objects>
           â”‚    â”‚         â”” <HookCaller 'pytest_runtest_protocol'>
           â”‚    â”” <member '_hookexec' of 'HookCaller' objects>
           â”” <HookCaller 'pytest_runtest_protocol'>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           â”‚    â”‚               â”‚          â”‚        â”‚       â”” True
           â”‚    â”‚               â”‚          â”‚        â”” {'item': <Function test_send_email_raises_on_failure>, 'nextitem': <Coroutine test_create_payment_credit_card_success_method>}
           â”‚    â”‚               â”‚          â”” [<HookImpl plugin_name='runner', plugin=<module '_pytest.runner' from '/home/feanor/workspace/fast-ecommerce-back/.venv/lib/p...
           â”‚    â”‚               â”” 'pytest_runtest_protocol'
           â”‚    â”” <function _multicall at 0x7f4772b6e0c0>
           â”” <_pytest.config.PytestPluginManager object at 0x7f47726fd7f0>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    res = hook_impl.function(*args)
          â”‚         â”‚         â”” [<Function test_send_email_raises_on_failure>, <Coroutine test_create_payment_credit_card_success_method>]
          â”‚         â”” <member 'function' of 'HookImpl' objects>
          â”” <HookImpl plugin_name='runner', plugin=<module '_pytest.runner' from '/home/feanor/workspace/fast-ecommerce-back/.venv/lib/py...
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 118, in pytest_runtest_protocol
    runtestprotocol(item, nextitem=nextitem)
    â”‚               â”‚              â”” <Coroutine test_create_payment_credit_card_success_method>
    â”‚               â”” <Function test_send_email_raises_on_failure>
    â”” <function runtestprotocol at 0x7f4772756a20>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 137, in runtestprotocol
    reports.append(call_and_report(item, "call", log))
    â”‚       â”‚      â”‚               â”‚             â”” True
    â”‚       â”‚      â”‚               â”” <Function test_send_email_raises_on_failure>
    â”‚       â”‚      â”” <function call_and_report at 0x7f4772756e80>
    â”‚       â”” <method 'append' of 'list' objects>
    â”” [<TestReport 'tests/services/mail/test_mail_clients.py::test_send_email_raises_on_failure' when='setup' outcome='passed'>]
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 244, in call_and_report
    call = CallInfo.from_call(
           â”‚        â”” <classmethod(<function CallInfo.from_call at 0x7f4772757240>)>
           â”” <class '_pytest.runner.CallInfo'>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 353, in from_call
    result: TResult | None = func()
            â”‚                â”” <function call_and_report.<locals>.<lambda> at 0x7f47616485e0>
            â”” +TResult
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 245, in <lambda>
    lambda: runtest_hook(item=item, **kwds),
            â”‚                 â”‚       â”” {}
            â”‚                 â”” <Function test_send_email_raises_on_failure>
            â”” <HookCaller 'pytest_runtest_call'>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           â”‚    â”‚         â”‚    â”‚     â”‚    â”‚                  â”‚       â”” False
           â”‚    â”‚         â”‚    â”‚     â”‚    â”‚                  â”” {'item': <Function test_send_email_raises_on_failure>}
           â”‚    â”‚         â”‚    â”‚     â”‚    â”” <member '_hookimpls' of 'HookCaller' objects>
           â”‚    â”‚         â”‚    â”‚     â”” <HookCaller 'pytest_runtest_call'>
           â”‚    â”‚         â”‚    â”” <member 'name' of 'HookCaller' objects>
           â”‚    â”‚         â”” <HookCaller 'pytest_runtest_call'>
           â”‚    â”” <member '_hookexec' of 'HookCaller' objects>
           â”” <HookCaller 'pytest_runtest_call'>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           â”‚    â”‚               â”‚          â”‚        â”‚       â”” False
           â”‚    â”‚               â”‚          â”‚        â”” {'item': <Function test_send_email_raises_on_failure>}
           â”‚    â”‚               â”‚          â”” [<HookImpl plugin_name='threadexception', plugin=<module '_pytest.threadexception' from '/home/feanor/workspace/fast-ecommerc...
           â”‚    â”‚               â”” 'pytest_runtest_call'
           â”‚    â”” <function _multicall at 0x7f4772b6e0c0>
           â”” <_pytest.config.PytestPluginManager object at 0x7f47726fd7f0>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    res = hook_impl.function(*args)
          â”‚         â”‚         â”” [<Function test_send_email_raises_on_failure>]
          â”‚         â”” <member 'function' of 'HookImpl' objects>
          â”” <HookImpl plugin_name='runner', plugin=<module '_pytest.runner' from '/home/feanor/workspace/fast-ecommerce-back/.venv/lib/py...
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 179, in pytest_runtest_call
    item.runtest()
    â”‚    â”” <function Function.runtest at 0x7f4772667560>
    â”” <Function test_send_email_raises_on_failure>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1720, in runtest
    self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    â”‚    â”‚                                   â”” <Function test_send_email_raises_on_failure>
    â”‚    â”” <property object at 0x7f47728b6250>
    â”” <Function test_send_email_raises_on_failure>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           â”‚    â”‚         â”‚    â”‚     â”‚    â”‚                  â”‚       â”” True
           â”‚    â”‚         â”‚    â”‚     â”‚    â”‚                  â”” {'pyfuncitem': <Function test_send_email_raises_on_failure>}
           â”‚    â”‚         â”‚    â”‚     â”‚    â”” <member '_hookimpls' of 'HookCaller' objects>
           â”‚    â”‚         â”‚    â”‚     â”” <HookCaller 'pytest_pyfunc_call'>
           â”‚    â”‚         â”‚    â”” <member 'name' of 'HookCaller' objects>
           â”‚    â”‚         â”” <HookCaller 'pytest_pyfunc_call'>
           â”‚    â”” <member '_hookexec' of 'HookCaller' objects>
           â”” <HookCaller 'pytest_pyfunc_call'>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           â”‚    â”‚               â”‚          â”‚        â”‚       â”” True
           â”‚    â”‚               â”‚          â”‚        â”” {'pyfuncitem': <Function test_send_email_raises_on_failure>}
           â”‚    â”‚               â”‚          â”” [<HookImpl plugin_name='python', plugin=<module '_pytest.python' from '/home/feanor/workspace/fast-ecommerce-back/.venv/lib/p...
           â”‚    â”‚               â”” 'pytest_pyfunc_call'
           â”‚    â”” <function _multicall at 0x7f4772b6e0c0>
           â”” <_pytest.config.PytestPluginManager object at 0x7f47726fd7f0>
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    res = hook_impl.function(*args)
          â”‚         â”‚         â”” [<Function test_send_email_raises_on_failure>]
          â”‚         â”” <member 'function' of 'HookImpl' objects>
          â”” <HookImpl plugin_name='python', plugin=<module '_pytest.python' from '/home/feanor/workspace/fast-ecommerce-back/.venv/lib/py...
  File "/home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/_pytest/python.py", line 166, in pytest_pyfunc_call
    result = testfunction(**testargs)
             â”‚              â”” {'mocker': <pytest_mock.plugin.MockerFixture object at 0x7f47684a9d90>}
             â”” <function test_send_email_raises_on_failure at 0x7f47684a18a0>

  File "[32m/home/feanor/workspace/fast-ecommerce-back/tests/services/mail/[0m[32m[1mtest_mail_clients.py[0m", line [33m120[0m, in [35mtest_send_email_raises_on_failure[0m
    [1msend_mail[0m[1m([0m[1mmessage[0m[1m,[0m [1mdb[0m[35m[1m=[0m[1mmock_db[0m[1m)[0m
    [36mâ”‚         â”‚           â”” [0m[36m[1m<function test_send_email_raises_on_failure.<locals>.<lambda> at 0x7f4769711c60>[0m
    [36mâ”‚         â”” [0m[36m[1mMailMessage(from_email='rachel63@example.com', to_emails='mmckay@example.net', subject='Perform never blue relate size walk',...[0m
    [36mâ”” [0m[36m[1m<function send_mail at 0x7f476c945440>[0m

> File "[32m/home/feanor/workspace/fast-ecommerce-back/app/mail/[0m[32m[1mservices.py[0m", line [33m87[0m, in [35msend_mail[0m
    [1msend_mail_sendgrid_legacy[0m[1m([0m
    [36mâ”” [0m[36m[1m<function send_mail_sendgrid_legacy at 0x7f476c8f6700>[0m

  File "[32m/home/feanor/workspace/fast-ecommerce-back/app/mail/[0m[32m[1mservices.py[0m", line [33m305[0m, in [35msend_mail_sendgrid_legacy[0m
    [1msend_mail_error[0m[1m([0m[1m)[0m
    [36mâ”” [0m[36m[1m<function send_mail_error at 0x7f476c9eb880>[0m

  File "[32m/home/feanor/workspace/fast-ecommerce-back/app/mail/[0m[32m[1mservices.py[0m", line [33m97[0m, in [35msend_mail_error[0m
    [35m[1mraise[0m [1mSendMailError[0m
    [36m      â”” [0m[36m[1m<class 'app.mail.services.SendMailError'>[0m

[31m[1mapp.mail.services.SendMailError[0m

tests/services/payment/test_process_payment_mercado_pago_credit_card.py::test_create_payment_credit_card_token_success PASSED
tests/services/payment/test_process_payment_mercado_pago_credit_card.py::test_create_payment_credit_card_invalid_type PASSED
tests/services/payment/test_process_payment_mercado_pago_credit_card.py::test_create_payment_credit_card_missing_method_id PASSED
tests/services/payment/test_process_payment_mercado_pago_pix.py::test_create_payment_pix_success PASSED
tests/services/payment/test_process_payment_mercado_pago_pix.py::test_create_payment_pix_invalid_type PASSED
tests/services/product/test_create_product.py::test_give_valid_product_payload_should_create_product FAILED

=================================== FAILURES ===================================
____________ test_give_valid_product_payload_should_create_product _____________

asyncdb = async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.engine.AsyncEngine object at 0x7f4761a40290>, autoflush=True, expire_on_commit=False)

    @pytest.mark.asyncio
    async def test_give_valid_product_payload_should_create_product(
        asyncdb,
    ) -> None:
        """Must create valid product."""
        category = CategoryFactory()
        config_fee = CreditCardFeeConfigFactory()
        async with asyncdb() as db:
            db.add_all([category, config_fee])
            await db.commit()
        description = {'content': 'test', 'description': 'test'}
    
        product_data = ProductCreate(
            name=fake.name(),
            uri=fake_url(),
            price=fake_decimal(),
            description=description,
            image_path=fake_url_path(),
            category_id=category.category_id,
            sku=fake.pystr(),
        )
    
        # Act
        product_response = await create_product(product_data, db=asyncdb)
    
        # Assert
        assert product_response
        assert isinstance(product_response, ProductInDBResponse)
>       assert product_response.product_id == 1
E       AssertionError: assert 16 == 1
E        +  where 16 = ProductInDBResponse(product_id=16, name='Yuri Pimenta', uri='http://www.sampaio.org/listsearch.php', price=Decimal('9617.41'), direct_sales=False, description={'content': 'test', 'description': 'test'}, image_path='posts/posts', installments_config=1, installments_list=None, category_id=27, discount=None, showcase=False, show_discount=False, heigth=None, width=None, weigth=None, length=None).product_id

tests/services/product/test_create_product.py:37: AssertionError
=============================== warnings summary ===============================
.venv/lib/python3.13/site-packages/testcontainers/core/waiting_utils.py:215
  /home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/testcontainers/core/waiting_utils.py:215: DeprecationWarning: The @wait_container_is_ready decorator is deprecated and will be removed in a future version. Use structured wait strategies instead: container.waiting_for(HttpWaitStrategy(8080).for_status_code(200)) or container.waiting_for(LogMessageWaitStrategy('ready'))
    @wait_container_is_ready()

.venv/lib/python3.13/site-packages/testcontainers/postgres/__init__.py:90
  /home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/testcontainers/postgres/__init__.py:90: DeprecationWarning: The @wait_container_is_ready decorator is deprecated and will be removed in a future version. Use structured wait strategies instead: container.waiting_for(HttpWaitStrategy(8080).for_status_code(200)) or container.waiting_for(LogMessageWaitStrategy('ready'))
    @wait_container_is_ready()

.venv/lib/python3.13/site-packages/testcontainers/redis/__init__.py:46
  /home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/testcontainers/redis/__init__.py:46: DeprecationWarning: The @wait_container_is_ready decorator is deprecated and will be removed in a future version. Use structured wait strategies instead: container.waiting_for(HttpWaitStrategy(8080).for_status_code(200)) or container.waiting_for(LogMessageWaitStrategy('ready'))
    @wait_container_is_ready(redis.exceptions.ConnectionError)

.venv/lib/python3.13/site-packages/dynaconf/base.py:167
  /home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/dynaconf/base.py:167: DeprecationWarning: Usage of `from dynaconf import settings` is now DEPRECATED in 3.0.0+. You are encouraged to change it to your own instance e.g: `settings = Dynaconf(*options)`
    warnings.warn(

tests/endpoints/cart/test_add_product.py::test_add_product_in_new_cart
  /home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/factory/base.py:509: SAWarning: relationship 'OrderDB.order_items' will copy column order.order_id to column order_items.order_id, which conflicts with relationship(s): 'OrderItemsDB.orders' (copies order.order_id to order_items.order_id). If this is not the intention, consider if these relationships should be linked with back_populates, or if viewonly=True should be applied to one or more if they are read-only. For the less common case that foreign key constraints are partially overlapping, the orm.foreign() annotation can be used to isolate the columns that should be written towards.   To silence this warning, add the parameter 'overlaps="orders"' to the 'OrderDB.order_items' relationship. (Background on this warning at: https://sqlalche.me/e/20/qzyx) (This warning originated from the `configure_mappers()` process, which was invoked automatically in response to a user-initiated operation.)
    return model_class(*args, **kwargs)

tests/endpoints/catalog/test_category_endpoint.py::test_create_category_invalid_data_should_return_422
  /usr/lib/python3.13/asyncio/events.py:89: DeprecationWarning: 'HTTP_422_UNPROCESSABLE_ENTITY' is deprecated. Use 'HTTP_422_UNPROCESSABLE_CONTENT' instead.
    self._context.run(self._callback, *self._args)

tests/repository/users/test_get_users.py::test_get_users_with_document_filter
  /usr/lib/python3.13/weakref.py:415: ResourceWarning: unclosed database in <sqlite3.Connection object at 0x7f4761862a70>
    return self.data[ref(key)]
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/repository/users/test_get_users.py::test_get_users_with_document_filter
  /usr/lib/python3.13/weakref.py:415: ResourceWarning: unclosed database in <sqlite3.Connection object at 0x7f47618985e0>
    return self.data[ref(key)]
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/repository/users/test_get_users.py::test_get_users_with_document_filter
  /usr/lib/python3.13/weakref.py:415: ResourceWarning: unclosed database in <sqlite3.Connection object at 0x7f476189a020>
    return self.data[ref(key)]
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/repository/users/test_get_users.py::test_get_users_with_document_filter
  /usr/lib/python3.13/weakref.py:415: ResourceWarning: unclosed database in <sqlite3.Connection object at 0x7f476189bd30>
    return self.data[ref(key)]
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/repository/users/test_get_users.py::test_get_users_with_document_filter
  /usr/lib/python3.13/weakref.py:415: ResourceWarning: unclosed database in <sqlite3.Connection object at 0x7f47615204f0>
    return self.data[ref(key)]
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/repository/users/test_get_users.py::test_get_users_no_filters
  /home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/psycopg/_queries.py:355: ResourceWarning: unclosed database in <sqlite3.Connection object at 0x7f47618984f0>
    pre = query[cur : m.span(0)[0]]
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/repository/users/test_get_users.py::test_get_users_no_filters
  /home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/psycopg/_queries.py:355: ResourceWarning: unclosed database in <sqlite3.Connection object at 0x7f47618e98a0>
    pre = query[cur : m.span(0)[0]]
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/repository/users/test_get_users.py::test_get_users_no_filters
  /home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/psycopg/_queries.py:355: ResourceWarning: unclosed database in <sqlite3.Connection object at 0x7f47616c6a70>
    pre = query[cur : m.span(0)[0]]
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/repository/users/test_get_users.py::test_get_users_no_filters
  /home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/psycopg/_queries.py:355: ResourceWarning: unclosed database in <sqlite3.Connection object at 0x7f4761521f30>
    pre = query[cur : m.span(0)[0]]
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/repository/users/test_get_users.py::test_get_users_no_filters
  /home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/psycopg/_queries.py:355: ResourceWarning: unclosed database in <sqlite3.Connection object at 0x7f47615214e0>
    pre = query[cur : m.span(0)[0]]
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/services/cart/test_cart_estimate.py::test_estimate_cart_with_product
tests/services/cart/test_cart_estimate.py::test_estimate_cart_with_coupon_discount
  /home/feanor/workspace/fast-ecommerce-back/.venv/lib/python3.13/site-packages/pydantic/main.py:528: UserWarning: Pydantic serializer warnings:
    PydanticSerializationUnexpectedValue(Expected `decimal` - serialized value may not be as expected [field_name='price', input_value=3778, input_type=int])
    PydanticSerializationUnexpectedValue(Expected `decimal` - serialized value may not be as expected [field_name='price', input_value=3778, input_type=int])
    return self.__pydantic_serializer__.to_json(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/services/product/test_create_product.py::test_give_valid_product_payload_should_create_product - AssertionError: assert 16 == 1
 +  where 16 = ProductInDBResponse(product_id=16, name='Yuri Pimenta', uri='http://www.sampaio.org/listsearch.php', price=Decimal('9617.41'), direct_sales=False, description={'content': 'test', 'description': 'test'}, image_path='posts/posts', installments_config=1, installments_list=None, category_id=27, discount=None, showcase=False, show_discount=False, heigth=None, width=None, weigth=None, length=None).product_id
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
============ 1 failed, 109 passed, 3 skipped, 18 warnings in 17.12s ============
make: *** [Makefile:41: test] Error 1
